<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>공지사항 메인 화면</title>

    <link rel="stylesheet" type="text/css" href="./jquery/ui/themes/jquery-ui.css" />

    <link rel="stylesheet" type="text/css" href="./jquery/plugin/jqGrid/css/ui.jqgrid.css" />
    <link rel="stylesheet" type="text/css" href="./jquery/plugin/jqGrid/plugins/ui.multiselect.css" />
    <link rel="stylesheet" type="text/css" href="./nsf/css/nsf.css" />
    <!-- swalert -->
    <script type="text/javascript" src="./jquery/plugin/sweetalert2/sweetalert2.js"></script>
    <link rel="stylesheet" href="./jquery/plugin/sweetalert2/css/sweetalert2.css" />
    <style type="text/css"></style>

    <script type="text/javascript" src="./jquery/jquery.js"></script>
    <script type="text/javascript" src="./jquery/ui/jquery-ui.js"></script>
    <script type="text/javascript" src="./jquery/plugin/jqGrid/plugins/ui.multiselect.js"></script>
    <script type="text/javascript" src="./jquery/plugin/jqGrid/i18n/grid.locale-en.js"></script>
    <script type="text/javascript" src="./jquery/plugin/jqGrid/jquery.jqGrid.js"></script>
    <script type="text/javascript" src="./jquery/plugin/form/jquery.form.js"></script>

    <script type="text/javascript" src="./nsf/nsf.js"></script>
  </head>
  <body>
    <div id="sectionA1" class="nsf-section nsf-widget-header ui-widget-header">
      <table>
        <tr>
          <td>
            <label>공지사항등록</label>
          </td>
          <td class="nsf-right">
            <button id="toggle" type="button"></button>
          </td>
        </tr>
      </table>
    </div>

    <div id="sectionA2" class="nsf-section-resize nsf-widget-content" additionHeight="100">
      <div class="nsf-panel">
        <div id="grid">
          <div class="body">
            <div class="nsf-btnbar">
              <table>
                <tr>
                  <td class="nsf-right">
                    <button id="btnFindM1" type="button" class="nsf-btn-search">조회</button>
                    <button style="display: " id="btnRegistM1" type="button" class="nsf-btn-add">추가</button>
                    <button style="display: none" id="btnRemoveM1" type="button" class="nsf-btn-delete">삭제</button>
                    <button style="display: none" id="btnProcessM1" type="button" class="nsf-btn-save">저장</button>
                  </td>
                </tr>
              </table>
            </div>
            <table id="jqGridM1"></table>
            <div id="jqGridnavM1"></div>
          </div>
        </div>
      </div>
    </div>

    <div id="sectionB1" class="nsf-widget-content">
      <div class="nsf-panel">
        <div id="grid">
          <div class="body">
            <div class="nsf-btnbar">
              <table>
                <tr>
                  <td class="nsf-right">
                    <button id="btnProcessP1" type="button" class="nsf-btn-save">저장</button>
                    <button id="eClose" type="button" class="nsf-btn-close">닫기</button>
                  </td>
                </tr>
              </table>
            </div>
          </div>
          <div class="nsf-form">
            <ul>
              <li class="nsf-form-li-2x">
                <span>제목</span>
                <input type="text" id="txtTitle" name="title" class="nsf-param nsf-status-ess" style="width: 472px" maxlength="100" />
              </li>
              <li>
                <span>사용여부</span>
                <select id="cboYnUse" name="ynUse" class="nsf-param nsf-status-ess"></select>
              </li>
              <li class="nsf-form-li-2x" style="height: 300px">
                <span>내용</span>
                <textarea id="txtContents" name="contents" cols="76" rows="20" class="nsf-param nsf-status-ess" maxlength="2000"></textarea>
              </li>
              <li style="display: none">
                <span>editFlag</span>
                <input type="text" id="txtEditFlag" name="editFlag" class="nsf-param" />
              </li>
              <li style="display: none">
                <span>공고번호</span>
                <input type="text" id="txtNoNotice" name="noNotice" class="nsf-param" />
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <script type="text/javascript">
      var delRowM1 = null;
      function fInitBefore() {
        NsfUtil.select.append("select[id=cboYnUse]", "N", "N");
        NsfUtil.select.append("select[id=cboYnUse]", "Y", "Y");
      }

      /**
       * generated By NsfJ Source Generator
       * 페이지 초기화
       * @since 1.0
       */
      function fInitPage() {
        jQuery("#sectionA1 #toggle").on("click", function () {
          jQuery("#sectionA2").slideToggle(null, function () {
            Nsf.resize();
          });
        });

        jQuery("#sectionA2 #grid .nsf-mini-vertical").on("click", function () {
          jQuery("#sectionA2 #grid .nsf-form-search").slideToggle(null, function () {
            Nsf.resize();
          });
        });

        jQuery("#jqGridM1").jqGrid({
          datatype: "local",
          colNames: ["", "공지번호", "사용여부", "제목", "내용", "contents2"],
          colModel: [
            { name: "editFlag", index: "editFlag", width: 25, sortable: true, classes: "nsf-status-lck", align: "center", editable: false }, //, hidden:true
            { name: "noNotice", index: "NO_NOTICE", width: 100, sortable: true, classes: "nsf-status-ess", align: "center", hidden: true, editable: false },
            {
              name: "ynUse",
              index: "YN_USE",
              width: 70,
              sortable: true,
              classes: "nsf-status-ess",
              align: "center",
              hidden: false,
              editable: false,
              edittype: "select",
              formatter: "select",
              editoptions: { value: "N:N;Y:Y" },
            },
            {
              name: "title",
              index: "TITLE",
              width: 300,
              sortable: true,
              classes: "nsf-status-ess",
              align: "left",
              hidden: false,
              editable: false,
              editoptions: { size: "100", maxlength: "100" },
            },
            { name: "contents", index: "CONTENTS", width: 800, sortable: false, classes: "nsf-status-ess", align: "left", hidden: false, editable: false },
            {
              name: "contents2",
              index: "CONTENTS2",
              width: 400,
              sortable: false,
              classes: "nsf-status-ess",
              align: "left",
              hidden: true,
              editable: false,
              edittype: "textarea",
              editoptions: { rows: "1", cols: "10" },
            },
          ],
          shrinkToFit: false,
          height: 200,
          gridview: true,
          rownumbers: true,
          pager: "#jqGridnavM1",
          rowNum: 200,
          rowList: [20, 30, 50, 100, 200, 500],
          pgbuttons: true,
          pginput: true,
          viewrecords: false,
          cellEdit: true,
          cellsubmit: "clientArray",

          onSortCol: function () {
            fFindjqGridM1();
          },
          onPaging: function () {
            fFindjqGridM1();
          },

          // editable:false 인 필드에서 발생
          onSelectCell: function (rowid, cellname, value, iRow, iCol) {
            //jQuery(this).saveCell(editCellM1.row,editCellM1.col);
            if (cellname == "idProgram") {
              var rowdata = jQuery(this).getRowData(rowid); // jQuery(this).jqGrid('getRowData',rowid);
              if (rowdata.editFlag == "C") jQuery(this).editCell(iRow, iCol);
            }
          },

          // 편집 상태를 들어가기 전 발생
          beforeEditCell: function (rowid, cellname, value, iRow, iCol) {
            editCellM1 = { id: rowid, name: cellname, val: value, row: iRow, col: iCol };
          },

          // 편집 상태로 들어간 후 발생
          afterEditCell: function (rowid, cellname, value, iRow, iCol) {
            if (cellname == "idProgram") {
              var rowdata = jQuery(this).getRowData(rowid);
              if (rowdata.editFlag != "C") jQuery(this).restoreCell(iRow, iCol);
            }
          },

          // 그리드에 저장하기 전에 발생
          beforeSaveCell: function (rowid, cellname, value, iRow, iCol) {},

          // 그리드에  저장할 때 발생
          beforeSubmitCell: function (rowid, cellname, value, iRow, iCol) {},

          // 그리드에 저장한 후에 발생
          afterSaveCell: function (rowid, cellname, value, iRow, iCol) {
            // 수정 표시
            var rowdata = jQuery(this).getRowData(rowid);
            if (rowdata.editFlag != "C" && rowdata.editFlag != "U") jQuery(this).setRowData(rowid, { editFlag: "U" });
          },

          onSelectRow: function () {},

          ondblClickRow: function (rowId, iRow, iCol, e) {
            fjqGridM1OnDblClick(e.target);
          },
        });

        jQuery("#jqGridM1").jqGrid("navGrid", "#jqGridnavM1", { add: false, edit: false, del: false, search: false, refresh: false });
        jQuery("#jqGridM1").jqGrid("navButtonAdd", "#jqGridnavM1", {
          caption: "",
          title: "Refresh",
          buttonicon: "ui-icon-refresh",
          onClickButton: function (e) {
            fFindjqGridM1();
          },
        });
        jQuery("#jqGridM1").jqGrid("navButtonAdd", "#jqGridnavM1", {
          caption: "",
          title: "Reorder Columns",
          onClickButton: function () {
            jQuery("#jqGridM1").jqGrid("columnChooser");
          },
        });

        jQuery("#btnFindM1").click(function () {
          fSearch();
          // 		fFindjqGridM1();
        });

        jQuery("#btnProcessM1").click(function () {
          fProcessM1();
        });

        jQuery("#btnProcessP1").click(function () {
          if (jQuery("#sectionB1 #editFlag").val() == "") {
            NsfMessage.alert("저장할 데이터를 입력해주세요");
            return;
          } else {
            fProcessP1();
          }
        });

        jQuery("#eClose").click(function () {
          jQuery("#sectionB1").dialog("close");
        });

        jQuery("#btnRegistM1").live("click", function () {
          fClearForm();

          jQuery("#sectionB1").dialog("open");
        });

        jQuery("#sectionB1").dialog({
          title: "공지사항등록",
          autoOpen: false,
          modal: true,
          height: 500,
          width: 700,
          bgiframe: true, //ie6에서 dialog위로 combo box 올라오는거 방지
          resizable: false,
          overlay: {
            opacity: 0.5,
            background: "black",
          },
          beforeClose: function () {},
        });

        jQuery("#sectionB1").dialog("close");
      }

      function fResizePageWidth() {
        jQuery("#jqGridM1").setGridWidth(jQuery("#sectionA2").width() - Nsf.offsetWidth);
      }

      function fResizePageHeight() {
        var height;
        height = jQuery("#sectionA2").height();
        height = height - (jQuery("#sectionA2 #grid .nsf-form-search").is(":visible") ? jQuery("#sectionA2 #grid .nsf-form-search").outerHeight() : 0);
        height = height - jQuery("#sectionA2 #grid .nsf-btnbar").outerHeight();
        height = height - jQuery("#sectionA2 #grid .nsf-mini-vertical").outerHeight();
        height = height - jQuery("#jqGridnavM1").outerHeight();
        height = height - Nsf.offsetHeight;
        jQuery("#jqGridM1").setGridHeight(height);
      }

      function fClearForm() {
        jQuery("#txtEditFlag").val("C");
        jQuery("#txtTitle").val("");
        jQuery("#txtContents").val("");
        jQuery("#cboYnUse").val("Y");
      }
    </script>
  </body>
</html>
