<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--
/**
 * ============================================================================
 * 사용자 UI
 *
 * @author <a href="mailto:@"></a>
 * @version 1.0
 * @since 1.0
 * <p>
 * History<br>
 * 1.0  2010.11.22  kym    initial version
 * 1.0  2013.09.01  cyg     initial version (북한이탈주민지원재단) 재개발
 * ============================================================================
 */
-->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>결의전표승인(신규)</title>

    <link rel="stylesheet" type="text/css" href="./jquery/ui/themes/jquery-ui.css"/>
    <link rel="stylesheet" type="text/css" href="./jquery/plugin/jqGrid/css/ui.jqgrid.css"/>
    <link rel="stylesheet" type="text/css" href="./jquery/plugin/jqGrid/plugins/ui.multiselect.css"/>
    <link rel="stylesheet" type="text/css" href="./nsf/css/nsf.css"/>
    <!--<link rel="stylesheet" type="text/css" href="./ClipReport4/css/clipreport.css"/>-->

    <script type="text/javascript" src="./jquery/jquery.js"></script>
    <script type="text/javascript" src="./jquery/ui/jquery-ui.js"></script>
    <script type="text/javascript" src="./jquery/ui/jquery.ui.datepicker-ko.js"></script>

    <script type="text/javascript" src="./jquery/plugin/blockUI/jquery.blockUI.js"></script>
    <script type="text/javascript" src="./jquery/plugin/jqGrid/i18n/grid.locale-en.js"></script>
    <script type="text/javascript" src="./jquery/plugin/jqGrid/jquery.jqGrid.js"></script>
    <script type="text/javascript" src="./jquery/plugin/jqGrid/plugins/ui.multiselect.js"></script>
    <script type="text/javascript" src="./jquery/plugin/jqGrid/jquery.jqGrid.js"></script>
    <script type="text/javascript" src="./jquery/plugin/form/jquery.form.js"></script>

    <script type="text/javascript" src="./nsf/nsf.js"></script>
    <!--<script type="text/javascript" src="./ClipReport4/js/clipreport.js"></script>-->
    <!--<script type="text/javascript" src="./ClipReport4/js/UserConfig.js"></script>-->

    <!-- [renewal] 2024 -->
    <link rel="stylesheet" type="text/css" href="./nsf/css/layout/default.css" />

    <script type="text/javascript">
    //-----------------------------------------------------------------
    //Initialize Section
    //-----------------------------------------------------------------
    var appUrl = "./webApp/wisen/ac/slp/control/AcSlp020CC";

    var editCellM1 = null;
    var delRowM1 = null;

    /**
     * generated By NsfJ Source Generator
     * 페이지 초기화
     * @since 1.0
     */

    function fInitPage() {
        //변수처리
        //delRowD1 = new Array();

        //화면 Toggle 처리
        //jQuery("#form").hide();
        //alert("=== step 01 === LINE : 106");

        //검색조건 , 그리드
        jQuery("#sectionA1 #toggle").on("click", function() {
            jQuery("#sectionA2").slideToggle(null, function() {
                Nsf.resize();
            });
        });
        jQuery("#sectionA2 #grid .nsf-mini-vertical").on("click", function() {
            jQuery("#sectionA2 #grid .nsf-form-search").slideToggle(null, function() {
                Nsf.resize();
            });
        });

        //분개내역, 관리항목
        jQuery("#sectionB1 #toggle").on("click", function() {
            jQuery("#sectionB2").slideToggle(null, function() {
                Nsf.resize();
            });
        });
        jQuery("#sectionB2").slideToggle(null, function() {
            Nsf.resize();
        });

        //--------------------------------------------------
        //Master 그리드 처리 - 결의전표 내역
        //--------------------------------------------------
        jQuery("#jqGridM1").jqGrid({
            datatype: "local",
            colNames: [
                ""
                , "법인코드"
                , "선택"
                , "승인상태"
                , "승인상태Old"
                , "회계일자"
                , "회계일자Old"
                , "회계번호"
                , "증빙제출여부"
                , "결의일자"
                , "결의부서"
                , "결의부서명"
                , "차변합계"
                , "대변합계"
                , "결의적요"
                , "결의번호"
                , "결의전표채번번호"
                , "결의전표번호"
                , "전표구분"
                , "입력경로"
                , "전표순번 개수"
                , "승인일자"
                , "승인자"
                , "승인취소자"
                , "승인취소일자"
                , "승인취소전회계일자"
                , "승인취소전회계번호"
                , "승인취소전회계전표번호"
                , "승인취소전회계전표채번번호"
                , "마감여부"
                , "등록자"
                , "등록일"
                , "수정자"
                , "수정일"
                , "회계전표채번번호"
                , "회계전표번호"
                , "예산코드"
                , "비목코드"
                , "결재상태"
                , "GW번호"
                , "GW문서"
            ],
            colModel: [
                {
                    name: "editFlag",
                    index: "editFlag",
                    width: 25,
                    sortable: false,
                    align: "center",
                    hidden: true,
                    classes: "nsf-status-lck"
                }
                , {
                name: "cdCompany",
                index: "CD_COMPANY",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "ynPrss",
                index: "YN_PRSS",
                width: 50,
                sortable: false,
                editable: false,
                edittype: "checkbox",
                editoptions: {
                    value: "Y:N"
                },
                hidden: true
            }
                , {
                name: "ynApprove",
                index: "YN_APPROVE",
                width: 80,
                sortable: true,
                classes: "nsf-status-ess",
                align: "center",
                hidden: false,
                editable: false,
                edittype: "select",
                formatter: "select",
                editoptions: {
                    value: "1:승인취소;2:승인;3:미승인;9:반려"
                }
            }
                , {
                name: "ynApproveOld",
                index: "YN_APPROVE_OLD",
                width: 80,
                sortable: true,
                classes: "nsf-status-ess",
                align: "left",
                hidden: true
            }
                , {
                name: "dtAccount",
                index: "DT_ACCOUNT",
                width: 80,
                sortable: true,
                align: "center",
                hidden: false,
                editable: true,
                editoptions: {
                    size: "10",
                    maxlength: "10"
                },
                classes: "nsf-status-ess"
            }
                , {
                name: "dtAccountOld",
                index: "DT_ACCOUNT_OLD",
                width: 80,
                sortable: true,
                align: "center",
                hidden: true
            }
                , {
                name: "noAccountRef",
                index: "NO_ACCOUNT_REF",
                width: 60,
                sortable: true,
                align: "center",
                hidden: false
            }
                , {
                name: "paPerSend",
                index: "PAFERSEND",
                width: 80,
                sortable: true,
                classes: "nsf-status-ess",
                align: "left",
                hidden: true,
                editable: true,
                edittype: "select",
                formatter: "select",
                editoptions: {
                    value: ":;" + "1:제출;2:미제출"
                }
            }
                , {
                name: "dtSlip",
                index: "DT_SLIP",
                width: 80,
                sortable: true,
                align: "center",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "cdDept",
                index: "CD_DEPT",
                width: 80,
                sortable: true,
                align: "center",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "nmDept",
                index: "NM_DEPT",
                width: 100,
                sortable: true,
                align: "left",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "amtDr",
                index: "AMT_DR",
                width: 110,
                sortable: true,
                align: "right",
                hidden: false,
                formatter: "number",
                formatoptions: {
                    decimalSeparator: ".",
                    thousandsSeparator: ",",
                    decimalPlaces: "0",
                    defaultValue: 0
                },
                editable: false,
                editoptions: {
                    size: "20",
                    maxlength: "20"
                },
                classes: "nsf-status-lck"
            }
                , {
                name: "amtCr",
                index: "AMT_CR",
                width: 110,
                sortable: true,
                align: "right",
                hidden: false,
                formatter: "number",
                formatoptions: {
                    decimalSeparator: ".",
                    thousandsSeparator: ",",
                    decimalPlaces: "0",
                    defaultValue: 0
                },
                editable: false,
                editoptions: {
                    size: "20",
                    maxlength: "20"
                },
                classes: "nsf-status-lck"
            }
                , {
                name: "txtRemark",
                index: "TXT_REMARK",
                width: 150,
                sortable: true,
                align: "left",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "noSlipRef",
                index: "NO_SLIP_REF",
                width: 80,
                sortable: true,
                align: "center",
                hidden: true
            }
                , {
                name: "noSlipSerial",
                index: "NO_SLIP_SERIAL",
                width: 100,
                sortable: true,
                align: "center",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "noSlip",
                index: "NO_SLIP",
                width: 80,
                sortable: true,
                align: "center",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "fgSlip",
                index: "FG_SLIP",
                width: 60,
                sortable: true,
                align: "center",
                hidden: false,
                edittype: "select",
                formatter: "select",
                editoptions: {
                    value: "3:대체;2:출금;1:입금"
                },
                classes: "nsf-status-lck"
            }
                , {
                name: "cdPath",
                index: "CD_PATH",
                width: 80,
                sortable: true,
                align: "center",
                hidden: false,
                edittype: "select",
                formatter: "select",
                editoptions: {
                    value: "03:결의전표등록;04:결의서승인;05:대체결의서(G/W);A1:감가상각자동전표;H1:급여자동전표;01:전기이월"
                },
                classes: "nsf-status-lck"
            }
                , {
                name: "cntSlip",
                index: "CNT_SLIP",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "dtApprove",
                index: "DT_APPROVE",
                width: 80,
                sortable: true,
                align: "center",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "noPersonApprove",
                index: "NO_PERSON_APPROVE",
                width: 80,
                sortable: true,
                align: "center",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "noPersonCancel",
                index: "NO_PERSON_CANCEL",
                width: 80,
                sortable: true,
                align: "center",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "dtCancel",
                index: "DT_CANCEL",
                width: 80,
                sortable: true,
                align: "center",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "dtAccountCen",
                index: "DT_ACCOUNT_CEN",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true,
                classes: "nsf-status-lck"
            }
                , {
                name: "noAccountRefCen",
                index: "NO_ACCOUNT_REF_CEN",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "noAccountCen",
                index: "NO_ACCOUNT_CEN",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "noAccountSerialCen",
                index: "NO_ACCOUNT_SERIAL_CEN",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "fgClose",
                index: "FG_CLOSE",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "idInsert",
                index: "ID_INSERT",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "dtInsert",
                index: "DT_INSERT",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "idUpdate",
                index: "ID_UPDATE",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "dtUpdate",
                index: "DT_UPDATE",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "noAccountSerial",
                index: "NO_ACCOUNT_SERIAL",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "noAccount",
                index: "NO_ACCOUNT",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "cdBudget",
                index: "CD_BUDGET",
                width: 90,
                sortable: true,
                align: "left",
                hidden: true,
                classes: "nsf-status-lck"
            }
                , {
                name: "cdDetail",
                index: "CD_DETAIL",
                width: 90,
                sortable: true,
                align: "left",
                hidden: true,
                classes: "nsf-status-lck"
            }
                , {
                name: "gwStatus",
                index: "GW_STATUS",
                width: 90,
                sortable: true,
                align: "center",
                hidden: false,
                classes: "nsf-status-lck",
                edittype: "select",
                formatter: "select",
                editoptions: {
                    value: "0:미상신;1:상신;2:진행;3:전결;4:종결;5:반려;6:보류;7:상신취소;9:본문수정"
                }
            }
                , {
                name: "noGwSerial",
                index: "NO_GW_SERIAL",
                width: 90,
                sortable: true,
                align: "left",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "nmGwSerial",
                index: "NM_GW_SERIAL",
                width: 90,
                sortable: true,
                align: "left",
                hidden: false,
                classes: "nsf-status-lck"
            }
            ],

            shrinkToFit: false,
            height: 200,
            gridview: false,
            rownumbers: false,
            pager: "#jqGridnavM1",
            pgbuttons: false,
            pginput: false,
            rowTotal: -1,
            rowNum: 200,
            //rowList: [20, 30, 50, 100, 200, 500],
        viewrecords: true,
            multiselect: true,
            //beforeRequest: fSetjqGridParamM1,
        cellEdit: true,
            cellsubmit: "clientArray",
            caption: "",

            onSortCol: function() {
                fFindjqGridM1();
            },
        onPaging: function() {
            fFindjqGridM1();
        },

        //=======================
        // Cell 선택되었을때 event 발생
        // editable:false 인 필드에서 발생
        //=======================
        onSelectCell: function(rowid, cellname, value, iRow, iCol) {
            //alert("=== beforeEditCell step 01 Start===");

            //분개내역 조회
            fFindjqGridD1();

        },
        //alert("=== beforeEditCell step 01 End ===");

        //=======================
        // 편집 상태를 들어가기 전 발생
        // editable:true 인 필드에서 발생
        //=======================
        beforeEditCell: function(rowid, cellname, value, iRow, iCol) {
            //alert("=== beforeEditCell step 01 Start ===");
            editCellM1 = {
                id: rowid,
                name: cellname,
                val: value,
                row: iRow,
                col: iCol
            };

            //분개내역 조회
            fFindjqGridD1();

        },
        //alert("=== beforeEditCell step 01 end ===");

        //=======================
        // 편집 상태로 들어간 후 발생
        //=======================
        afterEditCell: function(rowid, cellname, value, iRow, iCol) {
            var rowdata = jQuery(this).getRowData(rowid);

















        },
        //if(cellname == "ynApprove"){
        //	var rowdata = jQuery(this).getRowData(rowid); // jQuery(this).jqGrid('getRowData',rowid);
        //    if(rowdata.fgClose == 'Y')
        //		jQuery(this).restoreCell(iRow,iCol);
        //}
        //if(cellname == "dtAccount"){
        //	var rowdata = jQuery(this).getRowData(rowid); // jQuery(this).jqGrid('getRowData',rowid);
        //   if(rowdata.fgClose == "Y"){
        //    	jQuery(this).restoreCell(iRow,iCol);
        //    } else if(rowdata.ynApprove != "2" || rowdata.editFlag != "U"){
        //    	NsfMessage.alert(rowdata.ynApprove);
        //    	jQuery(this).restoreCell(iRow,iCol);
        //    }
        //}
        //alert("=== afterEditCell step 01 end ===");

        // 그리드에 저장하기 전에 발생
        beforeSaveCell: function(rowid, cellname, value, iRow, iCol) {
        },

        // 그리드에  저장할 때 발생
        beforeSubmitCell: function(rowid, cellname, value, iRow, iCol) {
        },

        //=======================
        // 그리드에 저장한 후에 발생
        //=======================
        afterSaveCell: function(rowid, cellname, value, iRow, iCol) {
            var rowdata = jQuery(this).getRowData(rowid);
 

            if (cellname == "ynApprove") {


                if (rowdata.ynApproveOld == "3" && value == "1") {
                    NsfMessage.alert("미승인전표는 승인취소 할 수 없습니다.");
                    jQuery(this).setRowData(rowid, {
                        ynApprove: rowdata.ynApproveOld
                    });
                    return;
                }
                if (rowdata.ynApproveOld == "2" && value == "3") {
                    NsfMessage.alert("승인전표는 승인취소를 선택하셔야합니다.");
                    jQuery(this).setRowData(rowid, {
                        ynApprove: rowdata.ynApproveOld
                    });
                    return;
                }
                if (rowdata.ynApproveOld == "1" && value == "3") {
                    NsfMessage.alert("승인취소전표는 승인을 선택하셔야합니다.");
                    jQuery(this).setRowData(rowid, {
                        ynApprove: rowdata.ynApproveOld
                    });
                    return;
                }
                if (value == "2") {

                    if (rowdata.dtAccount == null || rowdata.dtAccount == "") {
                        if (rowdata.dtAccountCen == null || rowdata.dtAccountCen == "") {
                            var dtAccount = rowdata.dtSlip;
                        }

                        if (dtAccount != "" && dtAccount != null)
                                jQuery(this).setRowData(rowid, {
                                    dtAccount: NsfUtil.format.date(dtAccount, "yyyy-MM-dd")
                                });
                            else
                                jQuery(this).setRowData(rowid, {
                                    dtAccount: NsfUtil.format.date(rowdata.dtAccountCen, "yyyy-MM-dd")
                                });
                    }
                }
            }

            // 수정 표시
            var rowdata = jQuery(this).getRowData(rowid);
            if (rowdata.editFlag != 'C' && rowdata.editFlag != 'U')
                    jQuery(this).setRowData(rowid, {
                        editFlag: "U"
                    });


        },

        //=======================
        // 전체선택 했을 경우
        //=======================
        onSelectAll: function() {
            var ids = jQuery(this).getDataIDs();
            for (var i = 0; i < ids.length; i++) {

                var rowid = ids[i];
                var name = jQuery(jQuery(this).getCell(rowid, "cb")).attr("name");
                var rowdata = jQuery(this).getRowData(rowid);

                if (jQuery("#" + name).is(":checked")) {
                    if (rowdata.ynApproveOld == "2") {
                        jQuery("#jqGridM1").setRowData(rowid, {
                            editFlag: "U"
                        }); //2011.12.27
                    } else {
                        jQuery("#jqGridM1").setRowData(rowid, {
                            editFlag: "U",
                            dtAccount: rowdata.dtSlip
                        });
                    }
                }
                    else {
                    // 2011.12.27 수정
                    jQuery("#jqGridM1").setRowData(rowid, {
                        editFlag: "",
                        dtAccount: rowdata.dtAccountOld
                    });
                }
            }

        },

        //=======================
        // Row 선택되었을때 event 발생
        //
        //=======================
        onSelectRow: function(rowid) {
            var rowdata = jQuery(this).getRowData(rowid);
            var name = jQuery(jQuery(this).getCell(rowid, "cb")).attr("name");
            if (jQuery("#" + name).is(":checked")) {
                if (rowdata.ynApprove == "2") {
                    jQuery(this).setRowData(rowid, {
                        editFlag: "U"
                    }); //, ynApprove : "1"
                } else {
                    jQuery(this).setRowData(rowid, {
                        editFlag: "U",
                        dtAccount: rowdata.dtSlip
                    }); //, ynApprove : "2"
                }
            }
                else {
                //NsfMessage.alert("2:"+rowdata.ynApproveOld+"/"+rowdata.ynApprove);
                // 2011.12.27 수정
                jQuery(this).setRowData(rowid, {
                    editFlag: "",
                    ynApprove: rowdata.ynApproveOld,
                    dtAccount: rowdata.dtAccountOld
                });
            }
        },

        //=======================
        // 더블클릭 했을때 event 발생
        //
        //=======================
        ondblClickRow: function(rowid, iRow, iCol, e) {

        }
    });

        //----------------------------
        // 그리드 Master Refresh
        //----------------------------
        jQuery("#jqGridM1").jqGrid("navGrid", "#jqGridnavM1", {
            excel: true,
            add: false,
            edit: false,
            del: false,
            search: false,
            refresh: false
        });
        jQuery("#jqGridM1").jqGrid("navButtonAdd", "#jqGridnavM1", {
            caption: "",
            title: "Refresh",
            buttonicon: "ui-icon-refresh",
            onClickButton: function(e) {
                fFindjqGridM1();
            }
        });
        //-----------------------------------------------
        // 그리드 Master 컬럼위치변경/숨김컬럼 추가/삭제
        //-----------------------------------------------
        jQuery("#jqGridM1").jqGrid("navButtonAdd", "#jqGridnavM1", {
            caption: "",
            title: "Reorder Columns",
            onClickButton: function() {
                jQuery("#jqGridM1").jqGrid("columnChooser");
            }
        });

        //=============
        //= Button Event  ==
        //=============
        //--------------------------------
        //조회버튼
        //--------------------------------
        jQuery("#btnFindM").click(function() {
            //화면 조정 - 그리드 활성화
            if (jQuery("#sectionB2").is(":visible") == true)
                jQuery("#sectionB2").slideToggle(null, function() {
                    Nsf.resize();
                });

            //조회
            fSearch()

        });
        //fFindjqGridM1();

        //--------------------------------
        //승인처리 버튼
        //--------------------------------
        jQuery("#btnApprove").click(function() {
            fProcessM1("A");
        });

        //--------------------------------
        //승인취소 처리 버튼
        //--------------------------------
        jQuery("#btnCancel").click(function() {
            fProcessM1("C");
        });

        //--------------------------------
        //결의전표 출력 처리 버튼
        //--------------------------------
        jQuery("#btnReport").click(function() {
            var selrow = jQuery("#jqGridM1").getGridParam('selrow');

            if (selrow == null) {
                alert("선택된 행이 없습니다.");
                return;
            }

            var h2 = jQuery("#sectionB2").height() * 1.5;

            jQuery("#sectionP1").append(jQuery('<iframe name="ifrmRexPreview1" id="ifrmRexPreview1" width="100%" height="100%"></iframe>').attr("src", "./ClipReport4/Clip.jsp")).dialog({
                title: "대체전표",
                modal: true,
                width: 1200,
                height: h2,
                bgiframe: true,
                //ie6에서 dialog위로 combo box 올라오는거 방지
            hide: {
                effect: "blind",
                    duration: 100
            },
            overlay: {
                opacity: 1,
                    background: "black"
            },
            beforeClose: function() {
                jQuery("#sectionP1").empty(); //
            }
        });
            fFindM2();
        });

        //--------------------------------
        //액셀 다운로드 버튼
        //--------------------------------
        jQuery("#btnExcelDownload").click(function() {
            //alert("=== 액셀 다운로드 버튼 === :");
            fExcelDBDownload();
        });

        jQuery("#btnDocument").click(function() {
            fOpenDocument();
        });

        //--------------------------------------------------
        //Detail 그리드 처리 - 분개내역
        //--------------------------------------------------
        jQuery("#jqGridD1").jqGrid({
            datatype: "local",
            colNames: [
                "결의전표채번번호"
                , "결의전표채번순번"
                , "번호"
                , "계정코드"
                , "계정명"
                , "차대구분"
                , "금액"
                , "통화"
                , "환율"
                , "외화금액"
                , "표준적요"
                , "표준적요명"
                , "적요"
                , "CC"
                , "CC명"
                , "PC"
                , "PC명"
                , "사업부"
                , "사업부명"
                , "예산코드"
                , "예산명"
                , "비목명"
                , "미결관리유형"
                , "미결채번번호"
                , "현금흐름계정"
                , "현금흐름계정명"
                , "원천관리계정"
                , "원천관리계쩡명"
                , "자동기표번호"
                , "계정잔액구분"
                , "계정특성"
                , "관리특성"
                , "예산통제구분"
                , "외화관리여부"
                , "장부관리코드1"
                , "장부관리항목1"
                , "장부관리코드2"
                , "장부관리항목2"
            ],
            colModel: [
                {
                    name: "noSlipSerial",
                    index: "noSlipSerial",
                    width: 130,
                    sortable: true,
                    align: "left",
                    hidden: true
                }
                , {
                name: "seqSlipSerial",
                index: "seqSlipSerial",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "noLine",
                index: "noLine",
                width: 50,
                sortable: true,
                align: "center",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "cdAccount",
                index: "cdAccount",
                width: 80,
                sortable: true,
                align: "left",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "nmAccount",
                index: "nmAccount",
                width: 100,
                sortable: true,
                align: "left",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "fgDrcr",
                index: "fgDrcr",
                width: 80,
                sortable: true,
                align: "center",
                hidden: false,
                edittype: "select",
                formatter: "select",
                editoptions: {
                    value: "1:차변;2:대변"
                },
                classes: "nsf-status-lck"
            }
                , {
                name: "amtAccount",
                index: "amtAccount",
                width: 120,
                sortable: true,
                align: "right",
                hidden: false,
                formatter: "number",
                formatoptions: {
                    decimalSeparator: ".",
                    thousandsSeparator: ",",
                    decimalPlaces: "0",
                    defaultValue: 0
                },
                editable: true,
                editoptions: {
                    size: "20",
                    maxlength: "20"
                },
                classes: "nsf-status-lck"
            }
                , {
                name: "unitCurrency",
                index: "unitCurrency",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "rateExchange",
                index: "rateExchange",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "famtAccount",
                index: "famtAccount",
                width: 120,
                sortable: true,
                align: "right",
                hidden: true,
                formatter: "number",
                formatoptions: {
                    decimalSeparator: ".",
                    thousandsSeparator: ",",
                    decimalPlaces: "0",
                    defaultValue: 0
                },
                editable: true,
                editoptions: {
                    size: "20",
                    maxlength: "20"
                },
                classes: "nsf-status-lck"
            }
                , {
                name: "cdRemark",
                index: "cdRemark",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "nmRemark",
                index: "nmRemark",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "txtRemark",
                index: "txtRemark",
                width: 250,
                sortable: true,
                align: "left",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "cdCc",
                index: "cdCc",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "nmCc",
                index: "nmCc",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "cdPc",
                index: "cdPc",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "nmPc",
                index: "nmPc",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "cdTopPc",
                index: "cdTopPc",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "nmTopPc",
                index: "nmTopPc",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "cdBudget",
                index: "cdBudget",
                width: 100,
                sortable: true,
                align: "left",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "nmBudget",
                index: "nmBudget",
                width: 150,
                sortable: true,
                align: "left",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "cdDetail",
                index: "cdDetail",
                width: 100,
                sortable: true,
                align: "left",
                hidden: false,
                classes: "nsf-status-lck",
                edittype: "select",
                formatter: "select",
                editoptions: {
                    value: "10000:보수(일반직);10100:보수(일반직);10200:고용부담금(일반직);11000:국비출연금;11100:국비출연금;12000:지방비출연금;12100:지방비출연금;20000:업무추진비;20100:사업추진비;20200:관서업무추진비;21000:국비보조금;21100:국비보조금;22000:지방비보조금;22100:지방비보조금;25000:사업 관서업무추진비;30000:여비;30100:국내여비;31000:입장료수입;31100:입장료수입;32000:교육수입;32100:교육수입;33000:문화수입;33100:문화수입;33200:문화수입;33300:문화수입;34000:주차료수입;34100:주차료수입;35000:사업 국내여비;35100:사업 국외여비;40100:일반수용비;40200:일용임금;40300:특근매식비;40400:임차료;40500:복리후생비;40600:유류비;40700:시설장비유지비;40800:기타운영비;40900:일반용역비;45000:사업 수용비;45100:사업 임차료;45200:사업 용역비;45300:사업 관리용역비;45400:사업 피복비;45500:사업 기타운영비;45600:사업 재료비;45700:사업 시설장비유지비;45800:사업 일용임금;50000:재산수입;50100:자산취득비;51000:편익시설;51100:편익시설;52000:대관수입;52100:대관수입;52300:대관수입(예수금);55000:사업 자산취득비;60000:사업연구수당(사업연구용역비);60100:연구수당;61000:후원회 적립금;61100:적립금(전기이월);62000:후원회 후원금;62100:후원회 기업후원금;62200:후원회 개인후원금;62300:후원회 기타후원금;63000:후원회 기타수입;63100:후원회 기타수입;65000:사업 연구비;70000:상용임금(운영직);70100:상용임금(운영직);70200:고용부담금(운영직);71000:기타수입;71100:이자수입;71600:기타수입(선납세금);71700:기타수입(예수금);71800:기타수입(임대료);71900:기타수입;75000:사고이월잔액;80000:사업 건설비;81000:수탁사업;81100:공동직장 어린이집 건립(정부보조);81200:2019년 창작커뮤니티 육성;81300:공동직장 어린이집 건립(후원 등);81400:직장공동어린이집(공단 20년 잔금);81500:직장공동어린이집(19년 미지급분);81600:2020년 창작커뮤니티 육성;81700:수탁연구과제(생물다양성 1차년도);85000:사업 기본 및 실시설계비;85100:사업 공사비;90000:이월금;91000:이월금;91100:이월금;95000:시설 노후환경개선"
                }
            }
                , {
                name: "fgUnsettled",
                index: "fgUnsettled",
                width: 100,
                sortable: true,
                align: "left",
                hidden: false,
                edittype: "select",
                formatter: "select",
                editoptions: {
                    value: "C1:채권;D1:채무;Z1:기타;C2:선급;D2:선수"
                },
                classes: "nsf-status-lck"
            }
                , {
                name: "noUnsettledSerial",
                index: "noUnsettledSerial",
                width: 100,
                sortable: true,
                align: "left",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "cdAccountCash",
                index: "cdAccountCash",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "nmAccountCash",
                index: "nmAccountCash",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "cdAccountOrg",
                index: "cdAccountOrg",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "nmAccountOrg",
                index: "nmAccountOrg",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "noAutoSlip",
                index: "noAutoSlip",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "fgBalance",
                index: "fgBalance",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true,
                edittype: "select",
                formatter: "select",
                editoptions: {
                    value: "1:차변;2:대변"
                }
            }
                , {
                name: "specAccount",
                index: "specAccount",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true,
                edittype: "select",
                formatter: "select",
                editoptions: {
                    value: "A:원계정;B:충당계정;D:전기이월이익잉여금;E:전기이월결손금;F:당기순손실;G:당기순이익;P:차기이월이익잉여금;Q:결산용자본금계정;R:결산용손익계정;S:처분전이익잉여금;T:처리전결손금;J:자본금;K:자본잉여금;L:자본조정;M:기타포괄손익누계액;N:이익잉여금"
                }
            }
                , {
                name: "specAsset",
                index: "specAsset",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true,
                edittype: "select",
                formatter: "select",
                editoptions: {
                    value: "A1:현금;B1:보통예금;B2:당좌예금;B3:제예금;B4:정기예금;B5:적금;B6:기타예금;D1:받을어음;B7:퇴직보험(신탁)예치금;D2:지급어음;DA:수취구매카드;DB:지불구매카드;DC:수취전자어음;DD:지불전자어음;E1:단기차입금;E2:외화단기차입금;E3:장기차입금;E4:외화장기차입금;E5:유동성장기부채;E6:사채;E7:당좌차월;E9:차입금이자;F1:부가세대급금;F2:부가세예수금;K1:유형자산;K2:무형자산;K0:투자자산;K3:건설중인자산;Q1:이익처분계정;Q2:임의적립계정;Q3:현금배당;G1:미지급비용;Q4:주식배당;Z1:미지급금;Z2:매출CUT-OFF;Z3:미지급금-카드;Z4:선급비용;Z5:예수금;Z6:급여;Y1:출연금수익;Y2:보조금수익;Y3:후원금수익"
                }
            }
                , {
                name: "ynBudget",
                index: "ynBudget",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true,
                edittype: "select",
                formatter: "select",
                editoptions: {
                    value: "N:미사용;X:실적사용;Y:통제"
                }
            }
                , {
                name: "ynForeignAmt",
                index: "ynForeignAmt",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true,
                edittype: "select",
                formatter: "select",
                editoptions: {
                    value: "N:미관리;Y:관리"
                }
            }
                , {
                name: "cdLedger1",
                index: "cdLedger1",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "ledgerData1",
                index: "ledgerData1",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "cdLedger2",
                index: "cdLedger2",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "ledgerData2",
                index: "ledgerData2",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
            ],

            shrinkToFit: false,
            height: 200,
            gridview: false,
            rownumbers: false,
            pager: "#jqGridnavD1",
            pgbuttons: false,
            pginput: false,
            rowTotal: -1,
            rowNum: 200,
            //rowList: [20, 30, 50, 100, 200, 500],
        viewrecords: true,
            multiselect: false,
            //beforeRequest: fSetjqGridParamM1,
        cellEdit: false,
            cellsubmit: "clientArray",
            caption: "",

            onSortCol: function() {
                fFindjqGridD1();
            },
        onPaging: function() {
            fFindjqGridD1();
        },

        //=======================
        // Cell 선택되었을때 event 발생
        // editable:false 인 필드에서 발생
        //=======================
        onSelectCell: function(rowid, cellname, value, iRow, iCol) {
            //관리항목 보여주기
            fGridD1Filter(rowid, "");
        },

        // 편집 상태를 들어가기 전 발생
        beforeEditCell: function(rowid, cellname, value, iRow, iCol) {
        },

        // 편집 상태로 들어간 후 발생
        afterEditCell: function(rowid, cellname, value, iRow, iCol) {
        },

        // 그리드에 저장하기 전에 발생
        beforeSaveCell: function(rowid, cellname, value, iRow, iCol) {
        },

        // 그리드에  저장할 때 발생
        beforeSubmitCell: function(rowid, cellname, value, iRow, iCol) {
        },

        // 그리드에 저장한 후에 발생
        afterSaveCell: function(rowid, cellname, value, iRow, iCol) {
        },

        //=======================
        // Row 선택되었을때 event 발생
        // cellEdit:false 인 필드에서 발생
        //=======================
        onSelectRow: function(rowid) {
            //alert("=== onSelectRow  === : rowid=" + rowid);
            //관리항목 보여주기
            fGridD1Filter(rowid, "");


        },
        //fFindjqGridD2();

        ondblClickRow: function(rowid, iRow, iCol, e) {
        }
    });

        //----------------------------
        // Detail 그리드 Refresh
        //----------------------------
        jQuery("#jqGridD1").jqGrid("navGrid", "#jqGridnavD1", {
            add: false,
            edit: false,
            del: false,
            search: false,
            refresh: false
        });
        jQuery("#jqGridD1").jqGrid("navButtonAdd", "#jqGridnavD1", {
            caption: "",
            title: "Refresh",
            buttonicon: "ui-icon-refresh",
            onClickButton: function(e) {
                fFindjqGridD1();
            }
        });
        //-----------------------------------------------
        // Detail 그리드 컬럼위치변경/숨김컬럼 추가/삭제
        //-----------------------------------------------
        jQuery("#jqGridD1").jqGrid("navButtonAdd", "#jqGridnavD1", {
            caption: "",
            title: "Reorder Columns",
            onClickButton: function() {
                jQuery("#jqGridD1").jqGrid("columnChooser");
            }
        });

        //--------------------------------------------------
        //Detail 그리드 처리 - 관리항목
        //--------------------------------------------------
        jQuery("#jqGridD2").jqGrid({
            datatype: "local",
            colNames: [
                "결의전표채번번호"
                , "결의전표채번순번"
                , "라인번호"
                , "출력순번"
                , "관리항목"
                , "관리항목명"
                , "관리항목자료"
                , "관리항목자료명"
                , "시스템구분"
                , "데이타형"
                , "데이타길이"
                , "입력구분"
                , "사용여부"
                , "입력구분경로"
                , "종합코드"
                , "테이블명"
                , "팝업프로그램"
                , "차변필수"
                , "대변필수"
                , "장부관리여부"
                , "SEQ_TEMP"
            ],
            colModel: [
                {
                    name: "noSlipSerial",
                    index: "noSlipSerial",
                    width: 100,
                    sortable: true,
                    align: "left",
                    hidden: true
                }
                , {
                name: "seqSlipSerial",
                index: "seqSlipSerial",
                width: 100,
                sortable: true,
                align: "center",
                hidden: true
            }
                , {
                name: "noLine",
                index: "noLine",
                width: 80,
                sortable: true,
                align: "center",
                hidden: true
            }
                , {
                name: "seqPrt",
                index: "seqPrt",
                width: 80,
                sortable: true,
                align: "center",
                hidden: true,
                classes: "nsf-status-lck"
            }
                , {
                name: "cdManage",
                index: "cdManage",
                width: 100,
                sortable: true,
                align: "left",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "nmManage",
                index: "nmManage",
                width: 180,
                sortable: true,
                align: "left",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "manageVal",
                index: "manageVal",
                width: 100,
                sortable: true,
                align: "left",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "nmManageVal",
                index: "nmManageVal",
                width: 180,
                sortable: true,
                align: "left",
                hidden: false,
                classes: "nsf-status-lck"
            }
                , {
                name: "fgManage",
                index: "fgManage",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "fgColumn",
                index: "fgColumn",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "lenColumn",
                index: "lenColumn",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "fgData",
                index: "fgData",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "ynUse",
                index: "ynUse",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "cdFgData",
                index: "cdFgData",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "cdMaster",
                index: "cdMaster",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "idTable",
                index: "idTable",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "idPopup",
                index: "idPopup",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "ynDr",
                index: "ynDr",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true,
                edittype: "select",
                formatter: "select",
                editoptions: {
                    value: "N:아니오;Y:예"
                },
                classes: "nsf-status-lck"
            }
                , {
                name: "ynCr",
                index: "ynCr",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true,
                edittype: "select",
                formatter: "select",
                editoptions: {
                    value: "N:아니오;Y:예"
                },
                classes: "nsf-status-lck"
            }
                , {
                name: "fgLedger",
                index: "fgLedger",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
                , {
                name: "seqTemp",
                index: "seqTemp",
                width: 100,
                sortable: true,
                align: "left",
                hidden: true
            }
            ],

            shrinkToFit: false,
            height: 200,
            gridview: false,
            rownumbers: false,
            pager: "#jqGridnavD2",
            pgbuttons: false,
            pginput: false,
            rowTotal: -1,
            rowNum: 200,
            //rowList: [20, 30, 50, 100, 200, 500],
        viewrecords: false,
            multiselect: false,
            //beforeRequest: fSetjqGridParamM1,
        cellEdit: true,
            cellsubmit: "clientArray",
            caption: "",

            onSortCol: function() {
                fFindjqGridD1();
            },
        onPaging: function() {
            fFindjqGridD1();
        },

        // editable:false 인 필드에서 발생
        onSelectCell: function(rowid, cellname, value, iRow, iCol) {
        },

        // 편집 상태를 들어가기 전 발생
        beforeEditCell: function(rowid, cellname, value, iRow, iCol) {
        },

        // 편집 상태로 들어간 후 발생
        afterEditCell: function(rowid, cellname, value, iRow, iCol) {
        },

        // 그리드에 저장하기 전에 발생
        beforeSaveCell: function(rowid, cellname, value, iRow, iCol) {
        },

        // 그리드에  저장할 때 발생
        beforeSubmitCell: function(rowid, cellname, value, iRow, iCol) {
        },

        // 그리드에 저장한 후에 발생
        afterSaveCell: function(rowid, cellname, value, iRow, iCol) {
        },

        onSelectRow: function() {
        },

        ondblClickRow: function(rowid, iRow, iCol, e) {
        }
    });

        //----------------------------
        // Detail 그리드 Refresh
        //----------------------------
        jQuery("#jqGridD2").jqGrid("navGrid", "#jqGridnavD2", {
            add: false,
            edit: false,
            del: false,
            search: false,
            refresh: false
        });
        jQuery("#jqGridD2").jqGrid("navButtonAdd", "#jqGridnavD2", {
            caption: "",
            title: "Refresh",
            buttonicon: "ui-icon-refresh",
            onClickButton: function(e) {
                fFindjqGridD1();
            }
        });
        //-----------------------------------------------
        // Detail 그리드 컬럼위치변경/숨김컬럼 추가/삭제
        //-----------------------------------------------
        jQuery("#jqGridD2").jqGrid("navButtonAdd", "#jqGridnavD2", {
            caption: "",
            title: "Reorder Columns",
            onClickButton: function() {
                jQuery("#jqGridD2").jqGrid("columnChooser");
            }
        });

        //====================
        //= Control Event : 조회조건   ==
        //====================
        //결의일자 From
        jQuery("#txtDtSlipFrH").datepicker({
            dateFormat: "yy-mm-dd"
        }); 
        jQuery("#txtDtSlipFrH").focus(function() {
            jQuery(this).data("value", jQuery(this).val());
        });

        //결의일자 To
        jQuery("#txtDtSlipToH").datepicker({
            dateFormat: "yy-mm-dd"
        });
        
        jQuery("#txtDtSlipToH").focus(function() {
            jQuery(this).data("value", jQuery(this).val());
        });

        //====================
        //= POPUP Event                   ==
        //====================
        // 결의부서 - 조회조건
        jQuery("#popCdDeptH1").click(function() {
            //           if(!fCheckSession()) return;
            var url = "./webView/wisen/fd/pop/control/PopHumanDeptAccount10SC";
            NsfPopup.modalDialog.open(url, [{
                name: "multiselect",
                value: "false"
            }, {
                name: "cdSearch",
                value: jQuery("#txtCdDeptH1").val()
            }], {
                title: "결의부서팝업",
                dialogWidth: "500px",
                dialogHeight: "400px"
            }, function(data) {
                jQuery("#txtCdDeptH1").val(data.cdDept);
                jQuery("#txtNmDeptH1").val(data.nmDept);
            });
        });
 
 

        // 결의전표번호 팝업 - 조회조건
        jQuery("#popNoSlipH").click(function() {
            var url = "./webView/wisen/fd/pop/control/PopSlipSerial10SC";
            //var data = {cdCompany:jQuery("#txtCdCompanyH").val(), cdDetail:jQuery("#txtCdPositionH").val(), addSql:"AND A.CD_MASTER = 'HU009'  AND A.YN_USE = 'Y' "};

            NsfPopup.modalDialog.open(url,
                                      [{
                                          name: "",
                                          value: "false"
                                      }], //{name: "params", value: JSON.stringify(data)}],
            {
                title: "결의전표번호팝업",
                dialogWidth: "700px",
                dialogHeight: "800px"
            },
            function(data) {
                jQuery("#txtNoSlipSerialH").val(data.noSlipSerial);
            }
            );
        });
 
        //사번팝업 popIdInsertH 결의사용자
        jQuery("#popIdInsertH").click(function() {
            var url = "./webView/wisen/fd/pop/control/PopUser10SC";
            NsfPopup.modalDialog.open(url, [{
                name: "multiselect",
                value: "false"
            }, {
                name: "cdSearch",
                value: jQuery("#txtIdInsertH").val()
            }], {
                title: "결의등록자팝업",
                dialogWidth: "600px",
                dialogHeight: "500px"
            }, function(data) {
                jQuery("#txtIdInsertH").val(data.idLogin);
                jQuery("#txtNmInsertH").val(data.nmLogin);
            });
        }); 

        //조회 조건 엔터키 처리시 조회처리
        NsfUtil.field.reset(".nsf-form-search");

        //---------------------------------------------
        //화면 초기화 Control Default Values Setting
        //---------------------------------------------
        jQuery("#cdCompany").val("10000"); //법인코드

        
        //금액
        jQuery("#txtAmtH").change(function() {
            jQuery(this).val(NsfUtil.format.number(jQuery(this).val(), 0));
        });


    }
    //alert("=== step 00 === : 초기화 끝");

    //---------------------------------------------
    //화면 사이즈 조정 Width-너비
    //---------------------------------------------
    function fResizePageWidth() {
        var width;
        width = jQuery("#sectionA2").width();
        jQuery("#sectionA2 #form").width(width);

        jQuery("#jqGridM1").setGridWidth(jQuery("#sectionA2").width() - Nsf.offsetWidth);
        jQuery("#jqGridD1").setGridWidth(jQuery("#sectionA2").width() - Nsf.offsetWidth);
        jQuery("#jqGridD2").setGridWidth(jQuery("#sectionA2").width() - Nsf.offsetWidth);

        var height;
        height = jQuery("#sectionB2").height();
        jQuery("#sectionB2").height(height * 1.5 + 20);




    }
    //	jQuery("#jqGridM1").setGridHeight(250);
    //	jQuery("#jqGridD1").setGridHeight(100);
    //	jQuery("#jqGridD2").setGridHeight(100);
    //---------------------------------------------
    //화면 사이즈 조정 Height-높이
    //---------------------------------------------
    function fResizePageHeight() {
        var height;

        height = jQuery("#sectionA2").height();
        jQuery("#sectionA2 #form").height(height);

        height = height - (jQuery("#sectionA2 #grid .nsf-form-search").is(":visible") ? jQuery("#sectionA2 #grid .nsf-form-search").outerHeight() : 0);
        height = height - jQuery("#sectionA2 #grid .nsf-btnbar").outerHeight();
        height = height - jQuery("#sectionA2 #grid .nsf-mini-vertical").outerHeight();
        height = height - jQuery("#jqGridnavM1").outerHeight();
        height = height - Nsf.offsetHeight;
        jQuery("#jqGridM1").setGridHeight(height);














    }
    //	alert("=== fResizePageHeight === step 01" +height);
    //	height = jQuery("#sectionC2").height();
    //	height = height - jQuery("#sectionC2 #form .nsf-btnbar").outerHeight();
    //	height = height - Nsf.offsetHeight;
    //	height =150;
    //	jQuery("#sectionC2").height(height);
    //	jQuery("#jqGridM1").setGridHeight(250);
    //	jQuery("#jqGridD1").setGridHeight(100);
    //alert("=== fResizePageHeight === step 01" +height);

    //---------------------------------------------
    //화면 사이즈 조정 ShowPanelMsg
    //---------------------------------------------
    function fShowPanelMsg() {
        jQuery("#sectionA2 #grid").hide();
        jQuery("#sectionA2 #form").show();
        Nsf.resize();
    }
    //---------------------------------------------
    //화면 사이즈 조정 HidePanelMsg()
    //---------------------------------------------
    function fHidePanelMsg() {
        jQuery("#sectionA2 #grid").show();
        Nsf.resize();
    }

    //========================
    //조회 (page = 1)
    //조회버튼에서 사용
    //========================
    function fSearch() {
        //alert("=== step 00 === : fSearch");

        jQuery("#jqGridM1").jqGrid("setGridParam", {
            page: 1,
            sortname: "",
            sortorder: ""
        });
        fFindjqGridM1();

    }
    //jQuery("#jqGridD1").clearGridData();

    //========================
    //조회
    //========================
     

     
    //NsfMessage.alert(error);

     

    function fFindjqGridD2() {
        if (!fCheckSession())
            return;
        //    jQuery("#jqGridD2").setGridParam({loadonce:false, datatype: "json"});  // 재조회를 위한 설정
        jQuery("#jqGridD2").trigger("reloadGrid");

    }
    //    jQuery("#jqGridD2").setGridParam({loadonce:true});                     // 로컬 정렬을 위한 설정

    

    //-------------------------------------------------------------------
    //함수명      : fExcelDBDownload
    //설  명      : 액셀다운로드
    //입력값      : rowid,iRow,iCol,obj
    //반환값      : --
    //-------------------------------------------------------------------
    function fExcelDBDownload() {
        var param = NsfUtil.field.serializeJSON(jQuery(".nsf-form-search"));
        var excelArr = {};
        excelArr = NsfUtiljqGrid.getExcelHeader(jQuery("#jqGridM1"), false);
        NsfRequest.http.doPost(appUrl,
                               [{
                                   name: "methodName",
                                   value: "excelDBDownload"
                               },
                                {
                                    name: "params",
                                    value: param
                                },
                                {
                                    name: "excelParams",
                                    value: JSON.stringify(excelArr)
                                }],
                               function(data) {

                               });
    }

    
    //-------------------------------------------------------------------
    //함수명      : fOpen
    //설  명       : 출력물 객체 생성 및 활성화
    //입력값      : data - 출력자료
    //       option - false:미리보기, true:출력
    //반환값      : --
    //-------------------------------------------------------------------
    function fOpen(data) {
        var url = document.location.protocol + "//" + document.location.host + "./ClipReport4/Clip.jsp";
        var reportkey = data.resultKey;
        var report = createImportJSPReport(url, reportkey, document.getElementById("sectionP1"));
        //실행
        report.setStartPrintButtonEvent(function() {
            report.printView();
        });
        report.view();
    }

    function fCheckBoxEvent() {

        var rowdata = jQuery("#jqGridM1").getRowData(jQuery("#jqGridM1").getGridParam("selrow"));
        //alert(rowdata);
        if (null == rowdata.noSlipSerial)
            return;

        btnReportRM1();

    }

    //-------------------------------------------------------------------
    //함수명      : fGridD1Filter
    //설  명       : 관리항목 필터링
    //입력값      : ho = 숨김옵션
    //                       All 전체 숨김
    //                        N 전체보임
    //                        D 행삭제
    // 		                "" 선택한 로우에 해당되는 관리항목 제외한 모든 항목 숨김
    //반환값      : --
    //-------------------------------------------------------------------
    function fGridD1Filter(selrow, ho) {

        //분개내역 선택한 로우 값 추출
        //var selrow = jQuery("#jqGridM1").getGridParam('selrow');
        var rowdataM1 = jQuery("#jqGridD1").getRowData(selrow);

        //관리항목 그리드 뺑뺑이~~~
        var ids = jQuery("#jqGridD2").getDataIDs();
        for (var i = 0; i < ids.length; i++) {
            var rowdata = jQuery("#jqGridD2").getRowData(ids[i]);

            //alert("rowdata.noSlipSerial=" + rowdata.noSlipSerial + ": rowdataM1.noSlipSerial=" + rowdataM1.noSlipSerial);
            //alert("rowdata.seqSlipSerial=" + rowdata.seqSlipSerial + ": rowdataM1.seqSlipSerial=" + rowdataM1.seqSlipSerial);

            if (ho == "All")
                jQuery("#jqGridD2" + " #" + ids[i]).hide();
            if (ho == "N")
                jQuery("#jqGridD2" + " #" + ids[i]).show();
            if (ho == "D") {
                //결의전체번호 , 결의순번 비교
                if (rowdata.noSlipSerial == rowdataM1.noSlipSerial && rowdata.seqSlipSerial == rowdataM1.seqSlipSerial) {
                    jQuery("#jqGridD2").delRowData(ids[i]);
                }
            }
            if (ho == "") {

                //결의전체번호 , 결의순번 비교
                if (rowdata.noSlipSerial == rowdataM1.noSlipSerial && rowdata.seqSlipSerial == rowdataM1.seqSlipSerial) {
                    jQuery("#jqGridD2" + " #" + ids[i]).show();
                } else {
                    jQuery("#jqGridD2" + " #" + ids[i]).hide();
                }
            }

        }

        jQuery("#jqGridD2").jqGrid("resetSelection");

    }
    //alert("=== fGridD1Filter step end === : ho=" + ho + " : selrow=" + selrow);

    function fOpenDocument() {

        var selrow = jQuery("#jqGridM1").getGridParam("selrow");
        var rowdata = jQuery("#jqGridM1").getRowData(selrow);
        var noGwSerial = rowdata.noGwSerial; // 그리드에서 선택한 데이터의 noGwSerial을 가져오자

        if (noGwSerial != null && noGwSerial != "") {
            var url = 'https://gnsmtest.gov-dooray.com/popup/workflow/approvals/' + noGwSerial; // test

            window.open(url, "_blank");
        } else {
            NsfMessage.alert("선택한 문서번호가 없습니다.");
        }

    }
    </script>
</head>
<body>
    <div id="sectionA1" class="nsf-section nsf-widget-header ui-widget-header">
        <table>
            <tr>
                <td>
                    <label>검색조건</label>
                </td>
                <td class="nsf-right">
                    <button id="toggle" type="button"></button>
                </td>
            </tr>
        </table>
    </div>
    <div id="sectionA2" class="nsf-section-resize nsf-widget-content">
        <div class="nsf-panel">
            <div id="grid">
                <div class="head nsf-form-search">
                    <ul>
                        <li class="nsf-form-li-2x">
                            <span class="nsf-required">결의일자</span>
                            <input type="text" id="txtDtSlipFrH" name="dtSlipFr" class="nsf-param nsf-status-ess nsf-center">
                            <label> ~ </label>
                            <input type="text" id="txtDtSlipToH" name="dtSlipTo" class="nsf-param nsf-status-ess nsf-center">
                        </li>
                        <li class="nsf-form-li-2x">
                            <span>승인여부</span>
                            <select id="cboYnApprveH" name="ynApprove" class="nsf-param ">
                                <option value=""></option>
                                <option value="1">승인취소</option>
                                <option value="2">승인</option>
                                <option value="3">미승인</option>
                                <option value="9">반려</option>
                            </select>
                        </li>

                        <li class="nsf-form-li-2x">
                            <span>발생경로</span>
                            <select id="cboFgModuleH" name="cdPath" class="nsf-param ">
                                <option value=""></option>
                                <option value="03">결의전표등록</option>
                                <option value="04">결의서승인</option>
                                <option value="05">대체결의서(G/W)</option>
                                <option value="A1">감가상각자동전표</option>
                                <option value="H1">급여자동전표</option>
                                <option value="01">전기이월</option>
                            </select>
                        </li>
                        <li class="nsf-form-li-2x">
                            <span>결의부서</span>
                            <input type="text" id="txtCdDeptH1" name="cdDept" class="nsf-param">
                            <button id="popCdDeptH1" class="nsf-btn-popup">
                                <a>&nbsp;</a>
                            </button>
                            <input type="text" id="txtNmDeptH1" name="nmDept" class="nsf-param nsf-status-lck" disabled=true>
                        </li>
                        </li>
                        <li class="nsf-form-li-2x">
                            <span>결의등록자</span>
                            <input type="text" id="txtIdInsertH" name="idInsert" class="nsf-param">
                            <button id="popIdInsertH" class="nsf-btn-popup">
                                <a>&nbsp;</a>
                            </button>
                            <input type="text" id="txtNmInsertH" name="nmInsert" class="nsf-param nsf-status-lck" disabled=true>
                        </li>
                        </li>

                        <li class="nsf-form-li-2x">
                            <span>결의금액</span>
                            <input type="text" id="txtAmtH" name="amt" class="nsf-param nsf-right">
                        </li>
                        <li class="nsf-form-li-2x">
                            <span>결의전표채번번호</span>
                            <input type="text" id="txtNoSlipSerialH" name="noSlipSerialH" class="nsf-param nsf-resize">
                            <button id="popNoSlipH" class="nsf-btn-popup">
                                <a>&nbsp;</a>
                            </button>
                        </li>
                        <li class="nsf-form-li-2x">
                            <span>결의서번호</span>
                            <input type="text" id="txtNoAnactSerialH" name="noAnactSerial" class="nsf-param">
                            <button id="popNoAnactSerialH" class="nsf-btn-popup">
                                <a>&nbsp;</a>
                            </button>
                        </li>
                        <!------------------->
                        <!-- 화면 숨긴 항목 -->
                        <!------------------->
                        <li class="nsf-form-li-3x" style="display: none">
                            <span>법인번호</span>
                            <input type="text" id="cdCompany" name="cdCompany" class="nsf-param nsf-resize nsf-status-lck" maxlength="10">
                            <button id="popCdCompany" class="nsf-btn-popup">
                                <a>&nbsp;</a>
                            </button>
                            <input type="text" id="nmCompany" name="nmCompany" class="nsf-param nsf-resize nsf-status-lck" disabled=true>
                        </li>

                    </ul>
                </div>

                <div class="nsf-border-top">
                    <center>
                        <img class="nsf-mini-vertical">
                        </img>
                    </center>
                </div>
                <div class="body">
                    <div class="nsf-btnbar">
                        <table>
                            <tr>
                                <td class="nsf-right">
                                    <button id="btnFindM" type="button" class="nsf-btn-search">결의전표조회</button>
                                    <button id="btnApprove" type="button" class="nsf-btn-confirm2">승인</button>
                                    <button id="btnCancel" type="button" class="nsf-btn-close">승인취소</button>
                                    <button id="btnReport" type="button" class="nsf-btn-print">출력</button>
                                    <button id="btnExcelDownload" type="button" class="nsf-btn-excel">엑셀다운로드</button>
                                    <button id="btnDocument" type="button" class="nsf-btn-copy">문서보기</button>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <table id="jqGridM1"></table>
                    <div id="jqGridnavM1"></div>
                </div>
            </div>
        </div>
    </div>
    <div id="sectionB1" class="nsf-section nsf-widget-header ui-widget-header">
        <table>
            <tr>
                <td>
                    <label>분개내역</label>
                </td>
                <td class="nsf-right">
                    <button id="toggle" type="button"></button>
                </td>
            </tr>
        </table>
    </div>
    <div id="sectionB2" class="nsf-section-resize nsf-widget-content">
        <div class="nsf-panel">
            <div id="grid">
                <div class="body">
                    <table>
                        <tr>
                            <td>
                                <label class="nsf-title">분개내역</label>
                            </td>
                        </tr>
                    </table>
                    <table id="jqGridD1"></table>
                    <div id="jqGridnavD1"></div>
                </div>
                <div class="body">
                    <table>
                        <tr>
                            <td>
                                <label class="nsf-title">관리항목</label>
                            </td>
                        </tr>
                    </table>
                    <table id="jqGridD2"></table>
                    <div id="jqGridnavD2"></div>
                </div>
            </div>
        </div>
        <!-- 미리보기  -->
        <div id="sectionP1" class="nsf-widget-content"></div>
    </div>
</body>
</html>
